<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	
<!-- Mirrored from wwwhomes.doc.ic.ac.uk/~rkarim/mediawiki/index.php?title=Registration_using_mutual_information&printable=yes&printable=yes by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 12 Mar 2018 13:50:23 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.1" />
		<meta name="robots" content="noindex,follow" />
		<meta name="keywords" content="Registration using mutual information" />
		<link rel="shortcut icon" href="http://wwwhomes.doc.ic.ac.uk/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.html" title="Rashed Karim Wiki (en)" />
		<link rel="alternate" type="application/rss+xml" title="Rashed Karim Wiki RSS Feed" href="index2ffe.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Rashed Karim Wiki Atom Feed" href="index890f.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Registration using mutual information - Rashed Karim Wiki</title>
		<link rel="stylesheet" href="skins/common/commonPrint69ad.css?207" type="text/css" />
		<link rel="stylesheet" href="index31a6.css?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="index663f.css?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="index6e6d.css?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="indexd70f.css?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/~rkarim/mediawiki/skins/common/IEFixes.js?207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/~rkarim/mediawiki/skins";
		var wgArticlePath = "indexafc5.html?title=$1";
		var wgScriptPath = "/~rkarim/mediawiki";
		var wgScript = "indexb3c9.html";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://wwwhomes.doc.ic.ac.uk/";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Registration_using_mutual_information";
		var wgTitle = "Registration using mutual information";
		var wgAction = "view";
		var wgArticleId = "72";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 422;
		var wgVersion = "1.15.1";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="skins/common/wikibits69ad.js?207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="skins/common/ajax69ad.js?207"></script>
		<script type="text/javascript" src="index6e36.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Registration_using_mutual_information skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Registration using mutual information</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Rashed Karim Wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<a name="Registration_using_mutual_information" id="Registration_using_mutual_information"></a><h2> <span class="mw-headline"> Registration using mutual information </span></h2>
<p>Mutual information (MI) measures <a href="http://en.wikipedia.org/wiki/Mutual_information" class="external text" title="http://en.wikipedia.org/wiki/Mutual_information" rel="nofollow">mutual dependence</a> of two random variables. In our case these variables are the pixel intensities of binary LA segmentation and Delayed enhancement MRI (LE-MRI). Quoting ITK's <a href="http://www.itk.org/ITK/applications/MutualInfo.html" class="external text" title="http://www.itk.org/ITK/applications/MutualInfo.html" rel="nofollow">website</a>, MI is a measure of how much information one random variable tells about another. The use of mutual information for medical image registration applications was independently introduced in 1995 by both Viola and Wells and Collignon. For two images, the mutual information is computed from the joint probability distribution of the images’ intensity or gray-values. When two images are aligned, the joint probability distribution is “peaky” resulting in a high mutual information value. Misregistration causes the distribution to disperse resulting in a low mutual information value. 
</p>
<div class="thumb tright"><div class="thumbinner" style="width:252px;"><a href="index0048.html?title=File:Before_reg_2.png" class="image" title="Before registration of LE-MRI with atrial geometry. Yellow outline shows LAS border."><img alt="" src="images/thumb/9/95/Before_reg_2.png/250px-Before_reg_2.png" width="250" height="247" border="0" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="index0048.html?title=File:Before_reg_2.png" class="internal" title="Enlarge"><img src="skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>Before registration of LE-MRI with atrial geometry. Yellow outline shows LAS border.</div></div></div>
<div class="thumb tright"><div class="thumbinner" style="width:252px;"><a href="indexb971.html?title=File:After_reg_2.png" class="image" title="After registration of LE-MRI with atrial geometry. Yellow outline shows LAS border."><img alt="" src="images/thumb/9/95/After_reg_2.png/250px-After_reg_2.png" width="250" height="247" border="0" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="indexb971.html?title=File:After_reg_2.png" class="internal" title="Enlarge"><img src="skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>After registration of LE-MRI with atrial geometry. Yellow outline shows LAS border.</div></div></div>
<a name="Preparing_image_for_MI_registration" id="Preparing_image_for_MI_registration"></a><h2> <span class="mw-headline"> Preparing image for MI registration </span></h2>
<p>Using the binary left atrium segmentation image, call it LAS, LAS is dilated by a specified number of iterations. Dilated regions are assigned a value of 0. Background assigned pixel value -1 and region inside LAS is 1. The program to do this can be found below:
</p>
<div class="thumb tright"><div class="thumbinner" style="width:252px;"><a href="indexbfa7.html?title=File:Before_registration.png" class="image" title="Before registration of LE-MRI with atrial geometry. Yellow outline shows LAS border."><img alt="" src="images/thumb/2/23/Before_registration.png/250px-Before_registration.png" width="250" height="239" border="0" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="indexbfa7.html?title=File:Before_registration.png" class="internal" title="Enlarge"><img src="skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>Before registration of LE-MRI with atrial geometry. Yellow outline shows LAS border.</div></div></div>
<div class="thumb tright"><div class="thumbinner" style="width:252px;"><a href="index4db3.html?title=File:After_registration.png" class="image" title="After registration. Yellow outline shows LAS border."><img alt="" src="images/thumb/1/14/After_registration.png/250px-After_registration.png" width="250" height="176" border="0" class="thumbimage" /></a>  <div class="thumbcaption"><div class="magnify"><a href="index4db3.html?title=File:After_registration.png" class="internal" title="Enlarge"><img src="skins/common/images/magnify-clip.png" width="15" height="11" alt="" /></a></div>After registration. Yellow outline shows LAS border.</div></div></div>
<pre> 
#include &lt;irtkImage.h&gt;
#include &lt;irtkDilation.h&gt;
#include &lt;fstream&gt;
int main(int argc, char **argv)
{

		ofstream output; 
       char *filename1, *filename2; 
       irtkGreyPixel *mra_p, *bin_mra_p&nbsp;;
	   int iterations;
	  
	   if (argc &lt; 3)
	   {
		   cerr &lt;&lt; &quot;Usage: prepareformi &lt;la_segmentation&gt; &lt;output&gt; &lt;dilation_iterations&gt; &quot; &lt;&lt; endl; 
		   exit(1); 
	   }


       // get files to subtract
       filename1 = argv[1];
       argv++;
       argc--;
	   filename2 = argv[1]; 
	   argv++;
       argc--;
	   iterations = atoi(argv[1]);    
	   argv++;
       argc--;

	
       // read image
       irtkGreyImage mra;
	   irtkGreyImage bin_mra; 

       double d;
       mra.Read(filename1);
       //le.Read(filename2);

	   bin_mra = mra; 

       mra_p = mra.GetPointerToVoxels();
	   bin_mra_p = bin_mra.GetPointerToVoxels();

      // cout &lt;&lt; &quot;number of voxels &quot; &lt;&lt; input1.GetNumberOfVoxels() &lt;&lt; endl;
      // cout &lt;&lt; &quot;number of voxels &quot; &lt;&lt; input2.GetNumberOfVoxels() &lt;&lt; endl;

	   // binarize
       for (int i=0;i&lt;mra.GetNumberOfVoxels();i++)
       {
			if (*mra_p &gt; 0)
				*bin_mra_p = 1; 
			else
				*bin_mra_p = 0;

			mra_p++;
			bin_mra_p++;
       }

	   // dilation
		irtkDilation&lt;irtkGreyPixel&gt; dilation;
		dilation.SetInput(&amp;bin_mra);
		dilation.SetOutput(&amp;bin_mra);
		for (i = 0; i &lt; iterations; i++) dilation.Run();
		
		// mask le image
		 mra_p = mra.GetPointerToVoxels();
		 bin_mra_p = bin_mra.GetPointerToVoxels();
		for (int i=0;i&lt;mra.GetNumberOfVoxels();i++)
       {
			if (*mra_p == 0 &amp;&amp; *bin_mra_p ==0)
				*bin_mra_p=-1; 
			if (*mra_p == 0 &amp;&amp; *bin_mra_p == 1)
				*bin_mra_p=0; 
			if (*mra_p == 1 &amp;&amp; *bin_mra_p == 1)
				*bin_mra_p = 1; 

			mra_p++;
			bin_mra_p++;
	   }

	   bin_mra.Write(filename2); 
}

                                                                     
 </pre>
<p>With the mask image prepared by the above program, the rreg function from the <a href="http://www.doc.ic.ac.uk/~dr/software/" class="external text" title="http://www.doc.ic.ac.uk/~dr/software/" rel="nofollow">IRTK</a> toolbox performs mutual-information based registration: 
</p>
<pre> 
prepareformi &lt;LAS image&gt; &lt;rreg LAS mask&gt; &lt;dilation iterations = 5&gt;
rreg &lt;target = rreg LAS mask&gt; &lt;source = LE &gt; -dofout &lt; transformation parameters dof file &gt;
transformation &lt; source = LE &gt; &lt; target = LE_transformed &gt; -dofin &lt; dof file &gt; -target &lt; LAS image grid &gt; 
</pre>
<p>Here <b>prepareformi</b> is the source given above.
</p>
<!-- 
NewPP limit report
Preprocessor node count: 9/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key rkarim:pcache:idhash:72-0!1!0!!en!2!edit=0!printable=1 and timestamp 20180312125213 -->
<div class="printfooter">
Retrieved from "<a href="indexe28e.html?title=Registration_using_mutual_information">http://wwwhomes.doc.ic.ac.uk/~rkarim/mediawiki/index.php?title=Registration_using_mutual_information</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="indexe28e.html?title=Registration_using_mutual_information" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="indexad3a.html?title=Talk:Registration_using_mutual_information&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="index9c90.html?title=Registration_using_mutual_information&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="index82a9.html?title=Registration_using_mutual_information&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="indexd3f8.html?title=User:159.92.151.128" title="The user page for the ip you&#039;re editing as [.]" accesskey="." class="new">159.92.151.128</a></li>
				<li id="pt-anontalk"><a href="index7a1b.html?title=User_talk:159.92.151.128" title="Discussion about edits from this IP address [n]" accesskey="n" class="new">Talk for this IP</a></li>
				<li id="pt-anonlogin"><a href="indexc5d7.html?title=Special:UserLogin&amp;returnto=Registration_using_mutual_information" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(images/myWikiLogo.gif);" href="indexb3c9.html?title=Research_Wiki" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="indexb3c9.html?title=Research_Wiki">Main Page</a></li>
				<li id="n-Home"><a href="http://www.doc.ic.ac.uk/~rkarim/">Home</a></li>
				<li id="n-currentevents"><a href="index8cfe.html?title=Rashed_Karim_Wiki:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="indexa414.html?title=Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="index3455.html?title=Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="index3cd6.html?title=Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://wwwhomes.doc.ic.ac.uk/~rkarim/mediawiki/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Rashed Karim Wiki [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="index99cf.html?title=Special:WhatLinksHere/Registration_using_mutual_information" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="index32d9.html?title=Special:RecentChangesLinked/Registration_using_mutual_information" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="indexc7ac.html?title=Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="indexb9ae.html?title=Registration_using_mutual_information&amp;printable=yes&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="index999b.html?title=Registration_using_mutual_information&amp;oldid=422" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 17 August 2010, at 16:35.</li>
					<li id="viewcount">This page has been accessed 998 times.</li>
					<li id="privacy"><a href="index2a71.html?title=Rashed_Karim_Wiki:Privacy_policy" title="Rashed Karim Wiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="index1436.html?title=Rashed_Karim_Wiki:About" title="Rashed Karim Wiki:About">About Rashed Karim Wiki</a></li>
					<li id="disclaimer"><a href="index2f3a.html?title=Rashed_Karim_Wiki:General_disclaimer" title="Rashed Karim Wiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.497 secs. --></body>
<!-- Mirrored from wwwhomes.doc.ic.ac.uk/~rkarim/mediawiki/index.php?title=Registration_using_mutual_information&printable=yes&printable=yes by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 12 Mar 2018 13:50:23 GMT -->
</html>
