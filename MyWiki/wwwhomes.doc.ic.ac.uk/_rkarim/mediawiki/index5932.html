<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	
<!-- Mirrored from wwwhomes.doc.ic.ac.uk/~rkarim/mediawiki/index.php?title=Sirius_Google_maps_issue&printable=yes&printable=yes by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 12 Mar 2018 13:51:12 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta http-equiv="Content-Style-Type" content="text/css" />
		<meta name="generator" content="MediaWiki 1.15.1" />
		<meta name="robots" content="noindex,follow" />
		<meta name="keywords" content="Sirius Google maps issue" />
		<link rel="shortcut icon" href="http://wwwhomes.doc.ic.ac.uk/favicon.ico" />
		<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc.html" title="Rashed Karim Wiki (en)" />
		<link rel="alternate" type="application/rss+xml" title="Rashed Karim Wiki RSS Feed" href="index2ffe.php?title=Special:RecentChanges&amp;feed=rss" />
		<link rel="alternate" type="application/atom+xml" title="Rashed Karim Wiki Atom Feed" href="index890f.php?title=Special:RecentChanges&amp;feed=atom" />
		<title>Sirius Google maps issue - Rashed Karim Wiki</title>
		<link rel="stylesheet" href="skins/common/commonPrint69ad.css?207" type="text/css" />
		<link rel="stylesheet" href="index31a6.css?title=MediaWiki:Common.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="index663f.css?title=MediaWiki:Print.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="index6e6d.css?title=MediaWiki:Monobook.css&amp;usemsgcache=yes&amp;ctype=text%2Fcss&amp;smaxage=18000&amp;action=raw&amp;maxage=18000" type="text/css" />
		<link rel="stylesheet" href="indexd70f.css?title=-&amp;action=raw&amp;maxage=18000&amp;gen=css" type="text/css" />
		<!--[if lt IE 7]><script type="text/javascript" src="/~rkarim/mediawiki/skins/common/IEFixes.js?207"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script type= "text/javascript">/*<![CDATA[*/
		var skin = "monobook";
		var stylepath = "/~rkarim/mediawiki/skins";
		var wgArticlePath = "indexafc5.html?title=$1";
		var wgScriptPath = "/~rkarim/mediawiki";
		var wgScript = "indexb3c9.html";
		var wgVariantArticlePath = false;
		var wgActionPaths = {};
		var wgServer = "http://wwwhomes.doc.ic.ac.uk/";
		var wgCanonicalNamespace = "";
		var wgCanonicalSpecialPageName = false;
		var wgNamespaceNumber = 0;
		var wgPageName = "Sirius_Google_maps_issue";
		var wgTitle = "Sirius Google maps issue";
		var wgAction = "view";
		var wgArticleId = "403";
		var wgIsArticle = true;
		var wgUserName = null;
		var wgUserGroups = null;
		var wgUserLanguage = "en";
		var wgContentLanguage = "en";
		var wgBreakFrames = false;
		var wgCurRevisionId = 2945;
		var wgVersion = "1.15.1";
		var wgEnableAPI = true;
		var wgEnableWriteAPI = true;
		var wgSeparatorTransformTable = ["", ""];
		var wgDigitTransformTable = ["", ""];
		var wgRestrictionEdit = [];
		var wgRestrictionMove = [];
		/*]]>*/</script>

		<script type="text/javascript" src="skins/common/wikibits69ad.js?207"><!-- wikibits js --></script>
		<!-- Head Scripts -->
		<script type="text/javascript" src="skins/common/ajax69ad.js?207"></script>
		<script type="text/javascript" src="index6e36.php?title=-&amp;action=raw&amp;gen=js&amp;useskin=monobook"><!-- site js --></script>
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Sirius_Google_maps_issue skin-monobook">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
				<h1 id="firstHeading" class="firstHeading">Sirius Google maps issue</h1>
		<div id="bodyContent">
			<h3 id="siteSub">From Rashed Karim Wiki</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">Jump to: <a href="#column-one">navigation</a>, <a href="#searchInput">search</a></div>			<!-- start content -->
			<a name="Issue" id="Issue"></a><h2> <span class="mw-headline"> Issue </span></h2>
<ul><li> Google maps v2 deprecated in 2010 and finally removed in early 2014. Moved to v3
</li><li> Main changes to v3: 1) Global functions for declaring maps, events, etc removed. 2) Imposed a limit on geocoding and an OVER_QUERY_LIMIT returned if requests exceeded. 
</li></ul>
<a name="Implementation" id="Implementation"></a><h2> <span class="mw-headline"> Implementation </span></h2>
<ul><li> To tackle the problem of limits in geocoding, all postcodes are now geocoded in advanced and stored in <b>tutor_geo_location</b> table. 
</li><li> To populate geocodes of all existing tutor postcodes, the <b>populategeocodes.php</b> was written. This is an admin-only script that can be run to pick up postcodes with latitude = 0 in tutor_geo_location and geocode the postcode associated with it. Unless, tutor addresses are geocoded on tutor entry creation and address update, this should be run once every week at least to geocode newly added addresses. 
</li><li> <b>Note</b>: tutor_geo_location existed before, where UK postcodes were pulled out of tutor addresses and stored here 
</li></ul>
<a name="Changes_to_existing_files" id="Changes_to_existing_files"></a><h2> <span class="mw-headline"> Changes to existing files </span></h2>
<ul><li> <b>SearchTutorsByMap.php</b>: many changes, especially because geocoding was not performed on the fly and lat/longs were pulled from DB. 
</li><li> A new script file: <b>google_geocoder2.js</b>
</li></ul>
<a name="Issues_faced" id="Issues_faced"></a><h2> <span class="mw-headline"> Issues faced </span></h2>
<ul><li> <b>Markers not appearing on the map</b>: With <b>var maps</b> which was undefined when markers were being put using <b>placeMarkerAtPoint2</b> function. As the form in SearchTutorsByMap.php submits to itself, all the code inside the if statement below expects the map to be ready. However, the map was only previously created when page finished loading and the map was never ready. So, all of the <b>usePointFromPostcode</b> code had to be put inside a <b>$( document ).ready(function() {} );</b> JQuery function. 
</li></ul>
<pre>
if ($_POST['isSubmit'] == 1) { ... }
</pre>
<ul><li> The proper way to solve the above would really be using an ajax request to submit the search form and receive them through a JSON. The form submitting to itself is not a good way of doing this.
</li></ul>
<a name="Regular_maintenance" id="Regular_maintenance"></a><h2> <span class="mw-headline"> Regular maintenance </span></h2>
<ul><li> The tutor_geo_location table's lat and longs are not updated when addresses or added or updated for tutors, both old and new. 
</li><li> To update it run: XXXin/popXXXXXXXXodes.php, however, running it without cleaning tutor_geo_location lat and long column will only: 
<ul><li> Update for new tutors with new addresses. 
</li></ul>
</li><li> To do a complete update of geo locations for tutors: 
</li></ul>
<ul><li> <b>STEP 1</b>: empty the two DB columns in tutor_geo_location first:
</li></ul>
<pre>
update `tutor_geo_location` set latitude=0
update `tutor_geo_location` set longitude=0
</pre>
<p>and then:
</p>
<ul><li> <b>STEP 2</b>: Run XXXin/popXXXXXXXXodes.php. The over_query_limit will pop-up several times. Re-run the script several times to geocode any remaining lat,long = 0,0
</li></ul>
<p><br />
</p>
<a name="Issues" id="Issues"></a><h2> <span class="mw-headline"> Issues </span></h2>
<ul><li> In September 2014, the admin update of tutor addresses from viewTutorDetails.php was not updated on geocode table. To fix all tutors who's postcodes were not updated to geocodeentry, the <b>TutorGeoCodeUpdateAddress.php</b> script was run to fix addresses which did not match in <b>tutor</b> and <b>tutor_geo_location</b> tables. 
<ul><li> This script if run does not have any side-effects, only will extract postcodes from tutor table addresses match them with tutor_geo_location and update those entries in tutor_geo_location
</li></ul>
</li><li> In Jan 2015, the google_geocoder2.js was moved to the javascript folder from the cgi-bin folder. The reason being the cgi-bin folder on the new server is protected from direct URL querying.
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 13/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key rkarim:pcache:idhash:403-0!1!0!!en!2!edit=0!printable=1 and timestamp 20180312125703 -->
<div class="printfooter">
Retrieved from "<a href="indexc098.html?title=Sirius_Google_maps_issue">http://wwwhomes.doc.ic.ac.uk/~rkarim/mediawiki/index.php?title=Sirius_Google_maps_issue</a>"</div>
						<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>Views</h5>
		<div class="pBody">
			<ul>
	
				 <li id="ca-nstab-main" class="selected"><a href="indexc098.html?title=Sirius_Google_maps_issue" title="View the content page [c]" accesskey="c">Page</a></li>
				 <li id="ca-talk" class="new"><a href="index4024.html?title=Talk:Sirius_Google_maps_issue&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
				 <li id="ca-viewsource"><a href="indexd6e9-2.html?title=Sirius_Google_maps_issue&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
				 <li id="ca-history"><a href="index1daf.html?title=Sirius_Google_maps_issue&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-anonuserpage"><a href="indexd3f8.html?title=User:159.92.151.128" title="The user page for the ip you&#039;re editing as [.]" accesskey="." class="new">159.92.151.128</a></li>
				<li id="pt-anontalk"><a href="index7a1b.html?title=User_talk:159.92.151.128" title="Discussion about edits from this IP address [n]" accesskey="n" class="new">Talk for this IP</a></li>
				<li id="pt-anonlogin"><a href="index56c2.html?title=Special:UserLogin&amp;returnto=Sirius_Google_maps_issue" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(images/myWikiLogo.gif);" href="indexb3c9.html?title=Research_Wiki" title="Visit the main page [z]" accesskey="z"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="indexb3c9.html?title=Research_Wiki">Main Page</a></li>
				<li id="n-Home"><a href="http://www.doc.ic.ac.uk/~rkarim/">Home</a></li>
				<li id="n-currentevents"><a href="index8cfe.html?title=Rashed_Karim_Wiki:Current_events" title="Find background information on current events">Current events</a></li>
				<li id="n-recentchanges"><a href="indexa414.html?title=Special:RecentChanges" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="index3455.html?title=Special:Random" title="Load a random page [x]" accesskey="x">Random page</a></li>
				<li id="n-help"><a href="index3cd6.html?title=Help:Contents" title="The place to find out">Help</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="http://wwwhomes.doc.ic.ac.uk/~rkarim/mediawiki/index.php" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search Rashed Karim Wiki [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="index4a5c.html?title=Special:WhatLinksHere/Sirius_Google_maps_issue" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="index79b8.html?title=Special:RecentChangesLinked/Sirius_Google_maps_issue" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="indexc7ac.html?title=Special:SpecialPages" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="index5932.html?title=Sirius_Google_maps_issue&amp;printable=yes&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="indexd47c.html?title=Sirius_Google_maps_issue&amp;oldid=2945" title="Permanent link to this revision of the page">Permanent link</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 14 January 2015, at 14:51.</li>
					<li id="viewcount">This page has been accessed 332 times.</li>
					<li id="privacy"><a href="index2a71.html?title=Rashed_Karim_Wiki:Privacy_policy" title="Rashed Karim Wiki:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="index1436.html?title=Rashed_Karim_Wiki:About" title="Rashed Karim Wiki:About">About Rashed Karim Wiki</a></li>
					<li id="disclaimer"><a href="index2f3a.html?title=Rashed_Karim_Wiki:General_disclaimer" title="Rashed Karim Wiki:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.458 secs. --></body>
<!-- Mirrored from wwwhomes.doc.ic.ac.uk/~rkarim/mediawiki/index.php?title=Sirius_Google_maps_issue&printable=yes&printable=yes by HTTrack Website Copier/3.x [XR&CO'2014], Mon, 12 Mar 2018 13:51:12 GMT -->
</html>
